<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Letter Editor</title>
    <link rel="stylesheet" href="css/editor.css">
    <!-- Rete.js dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/rete@1.4.4/build/rete.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-vue-render-plugin@0.5.1/build/vue-render-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-connection-plugin@0.9.0/build/connection-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-context-menu-plugin@0.6.0/build/context-menu-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-area-plugin@0.2.1/build/area-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
</head>
<body>
    <div class="editor-container">
        <div class="sidebar">
            <h1>Letter Editor</h1>
            
            <div class="tabs">
                <button class="tab-btn active" data-tab="structure">Structure</button>
                <button class="tab-btn" data-tab="styling">Styling</button>
                <button class="tab-btn" data-tab="tokens">Tokens</button>
                <button class="tab-btn" data-tab="preview">Preview</button>
            </div>
            
            <!-- Structure Tab -->
            <div id="structure-tab" class="tab-content active">
                <h2>Letter Structure</h2>
                
                <div class="form-group">
                    <label for="letter-title">Letter Title</label>
                    <input type="text" id="letter-title" placeholder="Enter letter title">
                </div>
                
                <div class="form-group">
                    <label for="letter-signature">Signature</label>
                    <input type="text" id="letter-signature" placeholder="Enter signature">
                </div>
                
                <div class="form-group">
                    <label for="start-section">Start Section</label>
                    <select id="start-section">
                        <option value="">Select start section</option>
                    </select>
                </div>
                
                <div class="actions">
                    <button id="add-section-btn" class="btn">Add Section</button>
                    <button id="save-structure-btn" class="btn primary">Save Structure</button>
                </div>
            </div>
            
            <!-- Styling Tab -->
            <div id="styling-tab" class="tab-content">
                <h2>Letter Styling</h2>
                
                <div class="form-group">
                    <label for="theme-select">Theme</label>
                    <select id="theme-select">
                        <option value="elegant">Elegant</option>
                        <option value="modern">Modern</option>
                        <option value="vintage">Vintage</option>
                        <option value="minimal">Minimal</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="text-size">Text Size</label>
                    <select id="text-size">
                        <option value="small">Small</option>
                        <option value="medium">Medium</option>
                        <option value="large">Large</option>
                        <option value="x-large">Extra Large</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="custom-css">Custom CSS</label>
                    <textarea id="custom-css" placeholder="Enter custom CSS"></textarea>
                </div>
                
                <div class="actions">
                    <button id="save-styling-btn" class="btn primary">Save Styling</button>
                </div>
            </div>
            
            <!-- Tokens Tab -->
            <div id="tokens-tab" class="tab-content">
                <h2>Token Management</h2>
                
                <div class="form-group">
                    <label for="token-letter-name">Letter Name</label>
                    <input type="text" id="token-letter-name" placeholder="Enter letter name for token">
                </div>
                
                <div class="form-group">
                    <label for="token-creator">Creator</label>
                    <input type="text" id="token-creator" placeholder="Enter creator name">
                </div>
                
                <div class="actions">
                    <button id="generate-token-btn" class="btn primary">Generate Token</button>
                </div>
                
                <h3>Existing Tokens</h3>
                <div id="token-list" class="token-list">
                    <!-- Token items will be added here -->
                </div>
            </div>
            
            <!-- Preview Tab -->
            <div id="preview-tab" class="tab-content">
                <h2>Letter Preview</h2>
                
                <div class="form-group">
                    <label for="preview-token">Select Token</label>
                    <select id="preview-token">
                        <option value="">Select a token</option>
                    </select>
                </div>
                
                <div class="actions">
                    <button id="open-preview-btn" class="btn primary">Open Preview</button>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <h2>Visual Node Editor</h2>
            <div id="rete" class="node-editor"></div>
            <div class="editor-actions">
                <button id="export-json-btn" class="btn">Export JSON</button>
                <button id="import-json-btn" class="btn">Import JSON</button>
            </div>
        </div>
    </div>
    
    <!-- Section Editor Modal -->
    <div id="section-editor" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Section</h2>
                <button id="close-section-editor" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="section-id">Section ID</label>
                    <input type="text" id="section-id" placeholder="Enter unique section ID">
                </div>
                
                <div class="form-group">
                    <label for="section-content">Content</label>
                    <textarea id="section-content" placeholder="Enter HTML content"></textarea>
                </div>
                
                <div class="form-group checkbox">
                    <input type="checkbox" id="is-final-section">
                    <label for="is-final-section">This is a final section (no choices)</label>
                </div>
                
                <div id="choices-editor">
                    <h3>Choices</h3>
                    <div id="choices-list">
                        <!-- Choice items will be added here -->
                    </div>
                    <button id="add-choice-btn" class="btn">Add Choice</button>
                </div>
                
                <div class="actions">
                    <button id="save-section-btn" class="btn primary">Save Section</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Templates -->
    <template id="choice-template">
        <div class="choice-item">
            <div class="form-group">
                <label>Choice Text</label>
                <input type="text" class="choice-text" placeholder="Enter choice text">
            </div>
            <div class="form-group">
                <label>Next Section</label>
                <select class="next-section">
                    <option value="">Select next section</option>
                </select>
            </div>
            <button class="remove-choice-btn btn-small danger">&times;</button>
        </div>
    </template>
    
    <template id="token-item-template">
        <div class="token-item">
            <div class="token-info">
                <span class="token-value"></span>
                <span class="token-letter-name"></span>
            </div>
            <div class="token-actions">
                <button class="copy-token-btn btn-small">Copy Link</button>
                <button class="delete-token-btn btn-small danger">Delete</button>
            </div>
        </div>
    </template>
    
    <script src="js/token-manager.js"></script>
    <script src="js/editor.js"></script>
</body>
</html>
